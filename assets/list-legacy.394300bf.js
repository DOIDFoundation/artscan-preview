System.register(["./index-legacy.655bb272.js","./vendor-legacy.5567aa4d.js"],(function(t,e){"use strict";var i,s,o,r,n,a,d,c,h,l,p,g,m,u,y,b,w,v,k,$,f,x,O,S,D,I,z,L,j;return{setters:[t=>{i=t.w,s=t.Z,o=t.a,r=t.d,n=t.e,a=t.T,d=t.N,c=t.i,h=t.u,l=t.f,p=t.h,g=t.s,m=t.j,u=t.k,y=t.l,b=t.D,w=t.g,v=t.n},t=>{k=t.y,$=t.m,f=t.e,x=t.x,O=t.z,S=t.j,D=t.n,I=t.l,z=t.k,L=t.u,j=t.d}],execute:function(){t("q",(async t=>{const e=t.toLowerCase();let i=0,r=0;if(t!=s){const t=await o("scan",`{\n        owner(id:"${e}") {mints:totalTokensMinted,holders:totalTokenHolders}\n      }`),{holders:s=[],mints:n=[]}=t.owner;i=s,r=n}return{ownerNum:i,mintNum:r}}));const e=async(t,e={pageSize:5,page:1})=>{let{minter:a,doid:d,tokenID:c}=t;if(!a||a==s)return[];a=a.toLowerCase();const{tokens:h=[]}=await o("scan",`{tokens(${r(e)} where:{${n({minter:a,tokenID:c})}} orderBy:createdAt orderDirection:desc){\n        id tokenURI createdAt owner { id doids { name }\n      }}}`)||{};return h.map((t=>Object.assign((t=>{const e=(t=>{const{id:e,tokenURI:i}=t,[s,o]=e?e.toString().split("-"):[t.contract.id,t.tokenID];return{address:s,tokenID:o,slugID:o,ctime:1e3*t.createdAt,tokenURI:i}})(t),{owner:{id:s="",doids:o=[]}={}}=t;return Object.assign(e,{owner:s,doids:o.map((t=>({...t,name:i(t.name)})))})})(t),{minter:a,doid:d})))};t("b",(async t=>(await e(t))[0]));var C=Object.defineProperty,U=Object.getOwnPropertyDescriptor,P=(t,e,i,s)=>{for(var o,r=s>1?void 0:s?U(e,i):e,n=t.length-1;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&C(e,i,r),r};let R=class extends(a("")){constructor(){super(...arguments),this.type="inline"}render(){return"block"===this.type?k`<div class="block mx-auto my-8 text-center text-base"><i class="mdi mdi-loading mx-1"></i></div>`:k`<i class="mdi mdi-loading mr-1"></i> Loading...`}};P([$({type:String})],R.prototype,"type",2),R=P([f("loading-icon")],R);const _=(t,{persistent:e=!1}={})=>class extends t{constructor(){super(...arguments),this.onObserved=()=>{},this.unobserve=()=>this.observe$&&this.observer?.unobserve(this.observe$),this.observe=()=>{this.observer||(this.observe$||(this.observe$=this.$(":first-child")))&&(this.observer=new IntersectionObserver((t=>{t[0].intersectionRatio<=0||(this.onObserved(),e||this.unobserve())})),this.observer.observe(this.observe$))}}firstUpdated(){this.observe()}connectedCallback(){this.unobserve(),super.connectedCallback()}},N={url:{"0x1":"https://opensea.io/assets/ethereum","0xaa36a7":"https://testnets.opensea.io/assets/sepolia","0x5":"https://testnets.opensea.io/assets/goerli"},api:{"0x1":"https://api.opensea.io/api/v1/asset","0xaa36a7":"https://testnets-api.opensea.io/api/v1/asset","0x5":"https://testnets-api.opensea.io/api/v1/asset"}},B=t("a",(t=>N[t][d.chainId])),A=t=>{t=t.toLowerCase();var e=[];for(let o=0;o<t.length;o++){var i=t.charCodeAt(o);i>=32&&i<=47||i>=58&&i<=64||91==i||i>=93&&i<=96||i>=123?e.push(" "):e.push(t.charAt(o))}t=e.join("").trim(),e=[];var s=!1;for(let o=0;o<t.length;o++){let i=t.charAt(o);" "==i||"\t"==i||"\r"==i||"\n"==i||"\v"==i||"\f"==i?(s||e.push("-"),s=!0):(e.push(i),s=!1)}return e.join("")},M=t=>{const{background_color:e,owner:i="",external_link:s,asset_contract:o,collection:r}=t,n=t.image_url||t.image||"",a=t.name||r?.name;return{name:a,description:t.description||r?.description,slug:A(a),image:m(t.image_preview_url||t.image_thumbnail_url||n),raw:m(t.image_original_url||n),creator:t.creator?.address,owner:i,external_link:s,background_color:e}},T={store:sessionStorage,withoutEnv:!0,ttl:864e5};let q=0;const E=async(t,e=1024)=>{let i={};if(q)return await y(50),await E(t);q=u();try{i=await p.get(t),setTimeout((()=>{q=0}),Math.max(u()-q,e))}catch(s){q=0}return i},F=async(t="")=>{let e;if(!t)return{};c(t)&&(e=M(await p.get(t)));const i=await h(`meta.${t}`,T);if(e||(e=await i.get()),!e)try{e=M(await p.get(m(t))),e&&i.set(e)}catch{}return e??{}},H=t("g",(async t=>{let e;const{tokenURI:i,address:s,tokenID:o,doid:r,minter:n}=t;if(c(i)&&(e=await F(i)),!e&&i&&(e=await(await h(`meta.${i}`,T)).get()),e||(e=await(await h(`meta.${s}.${o}`,T)).get()),!e&&s&&o&&(e=await(async({address:t="",tokenID:e=""}={})=>{let i;const s=await h(`meta.${t}.${e}`,T);if(i=await s.get(),!i)try{i=M(await E(`${B("api")}/${t}/${e}/`)),i&&s.set(i)}catch{}return i??{}})(t)),!e&&i&&(e=await F(i)),e&&r)try{const t=await l(),i=await p.get(`https://raw.githubusercontent.com/DOIDFoundation/artscan-slugs/main/${t}/${g(r)}/${e.slug}.txt`);e.sync=i.includes(n)}catch{}return e??{}}));var V=Object.defineProperty,W=Object.getOwnPropertyDescriptor,Z=(t,e,i,s)=>{for(var o,r=s>1?void 0:s?W(e,i):e,n=t.length-1;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&V(e,i,r),r};const G=[48,64,128,256,384,512,640,750,828,1080,1200,1920,2048,3840];let J=class extends(_(a("i{position:relative;display:inline-flex;height:100%;width:100%;align-items:center;justify-content:center;overflow:hidden}i.empty,i.err,i:not(.loaded){background:linear-gradient(-45deg,rgba(238,201,121) 8%,rgb(187,131,68) 36%,rgba(238,201,121) 66%) 0% 0% / 2400px;animation:silk 4s linear infinite}i.err img{visibility:hidden}i img{height:auto;max-height:100%;width:auto;max-width:100%;-webkit-user-select:none;-moz-user-select:none;user-select:none;-o-object-fit:contain;object-fit:contain}@keyframes silk{0%{background-position:-2400px 0}to{background-position:2400px 0}}\n"))){constructor(){super(...arguments),this.el$=x(),this.src="",this.loaded=!1,this.stop=!1,this.loading="eager",this.sizes=void 0,this.w="100%",this.firstLoaded=this.loaded,this.imgLoaded=this.loaded,this.err=!1,this.show=!1,this.blobSrc="",this.onLoad=()=>{this.emit("loaded",this.imgLoaded=this.firstLoaded=!0)},this.onError=()=>{this.err=!1},this.onObserved=()=>{this.w=(this.el$.value?.getBoundingClientRect().width??"400")+"",this.show=!0}}get lazy(){return"lazy"===this.loading}get isInstantSrc(){return c(this.src)}get isResizableSrc(){return/\?(w|width)=/.test(this.src)}get requireComporess(){return!this.isResizableSrc&&!this.isInstantSrc&&!this.blobSrc}get uri(){if(!this.err&&this.show)return this.requireComporess?this.blobSrc:this.src}get empty(){return!(this.src||this.blobSrc)||!(this.uri||this.uriset)}get uriset(){if(this.err||!this.show||!this.isResizableSrc)return;const{origin:t,pathname:e}=new URL(this.src);return G.map((i=>`${[t+e]}?auto=format&w=${i}&width=${i} ${i}w`)).join(",")}get autoSizes(){return this.sizes?this.sizes:`(max-width: 768px) ${this.w}px, ${this.w}px`}shouldUpdate(t){return t.has("src")&&this.requireComporess&&(async(t,{maxW:e=400}={})=>new Promise((i=>{if(!t)return i("");const s=sessionStorage.getItem(`blob.${t}`);if(s)return i(s);const o=new Image;o.src=t,o.crossOrigin="anonymous",o.onload=async()=>{let[t,i]=[o.width,o.height],[s,d,c,h]=[0,0,t,i];t>e&&(i=e*(i/t),t=e),i>e&&(t=e*(t/i),i=e),o.height,o.width,r.width=t,r.height=i,n.drawImage(o,s,d,c,h,0,0,t,i),a()};const r=document.createElement("canvas"),n=r.getContext("2d"),a=()=>{r.toBlob((e=>{const s=URL.createObjectURL(e);sessionStorage.setItem(`blob.${t}`,s),i(s)}),"image/png",1)}})))(this.src).then((t=>this.blobSrc=t)),!0}connectedCallback(){super.connectedCallback(),"eager"===this.loading&&this.onObserved()}render(){return k`<i ${O(this.el$)} class="${S({loaded:this.firstLoaded,err:this.err,empty:this.empty,stop:this.stop})}">${D(this.isResizableSrc?this.uriset:this.uri,(()=>k`<img class="${S({invisible:!this.firstLoaded,"opacity-0":!this.firstLoaded})}" src="${I(this.uri)}" srcset="${I(this.uriset)}" sizes="${I(this.autoSizes)}" @load="${this.onLoad}" @error="${this.onError}">`))}</i>`}};Z([$({type:String})],J.prototype,"src",2),Z([$({type:Boolean})],J.prototype,"loaded",2),Z([$({type:Boolean})],J.prototype,"stop",2),Z([$({type:String})],J.prototype,"loading",2),Z([$({type:String})],J.prototype,"sizes",2),Z([z()],J.prototype,"w",2),Z([z()],J.prototype,"firstLoaded",2),Z([z()],J.prototype,"imgLoaded",2),Z([z()],J.prototype,"err",2),Z([z()],J.prototype,"show",2),Z([z()],J.prototype,"blobSrc",2),J=Z([f("img-loader")],J);var K=Object.defineProperty,Q=Object.getOwnPropertyDescriptor,X=(t,e,i,s)=>{for(var o,r=s>1?void 0:s?Q(e,i):e,n=t.length-1;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&K(e,i,r),r};let Y=class extends(a('.skeleton{display:inline-flex;height:100%;width:100%;flex-direction:column;gap:1rem}.p{height:100%;width:6rem;overflow:hidden;border-radius:.375rem;height:1em;background:rgba(222,226,230)}.p:after{content:"";display:block;height:100%;width:100%;background:linear-gradient(90deg,rgba(255,255,255,0) 8%,rgba(255,255,255,.8) 36%,rgba(255,255,255,0) 66%) 0% 0% / 1200px;animation:skeleton 3s ease-in-out infinite}.p:nth-child(2){width:9rem}.p:nth-child(3){width:12rem}@keyframes skeleton{0%{background-position:-1200px 0}to{background-position:1200px 0}}\n')){constructor(){super(...arguments),this.expect=!1,this.num=1,this.class=""}get groups(){return new Array(this.num)}render(){return this.expect?k`<slot></slot>`:k`<div class="skeleton ${S(this.$c([this.class]))}">${L(this.groups,(()=>k`<div class="p"></div>`))}</div>`}};X([$({type:Boolean})],Y.prototype,"expect",2),X([$({type:Number})],Y.prototype,"num",2),X([$({type:String})],Y.prototype,"class",2),Y=X([f("loading-skeleton")],Y);var tt=Object.defineProperty,et=Object.getOwnPropertyDescriptor,it=(t,e,i,s)=>{for(var o,r=s>1?void 0:s?et(e,i):e,n=t.length-1;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&tt(e,i,r),r};let st=class extends(_(a(".item{min-height:11rem}\n"))){constructor(){super(...arguments),this.item={},this.meta={},this.cook=async()=>{this.meta=await H(this.item),this.cooked=await b({DOIDName:this.doid,token:this.token})},this.onObserved=()=>{this.cook()},this.goto=()=>{this.cookedUri&&w(`/collection/${this.cookedUri}`)}}get doid(){return this.DOID?.doid}get createTime(){return this.item.ctime?new Date(this.item.ctime).toLocaleString():""}get token(){const{tokenID:t,slugID:e}=this.item;return{name:this.meta?.name,tokenID:t,slugID:e}}get cookedName(){return this.cooked?.parsed?.val}get cookedUri(){return this.cooked?.parsed?.uri}get tokenName(){return this.cooked?.parsed?.val}connectedCallback(){super.connectedCallback()}render(){return k`<div class="item p-4"><div class="font-medium"><loading-skeleton .expect="${this.tokenName}"><dui-link class="uri" href="${`/collection/${this.cookedUri}`}">${this.cookedUri}</dui-link></loading-skeleton></div><div class="flex gap-4 py-4"><img-loader class="shrink-0 w-24 h-24" .src="${this.meta?.image}" loading="lazy"></img-loader><div><loading-skeleton .expect="${this.meta.name}" num="3"><div class="mb-2 flex items-center"><b class="inline-block text-white rounded py-0.5 px-1 text-xs mr-1.5 ${S({"bg-green-600":!!this.meta.sync,"bg-gray-500":!this.meta.sync})}">${this.meta.sync?"Verified":"Unverified"}</b><dui-link class="text-base" href="${`/collection/${this.cookedUri}`}">${this.meta.name}<i class="mdi mdi-ethereum ml-1"></i></dui-link></div><p class="break-words break-all text-xs lg_text-sm text-gray-500">${this.meta?.description}</p></loading-skeleton></div></div><div class="text-xs">Minted on ${this.createTime}, Owned by ${D(this.item.doids?.length,(()=>k`${this.item.doids?.at(0)?.name}`),(()=>k`<dui-address .address="${this.item.owner}"></dui-address>`))}</div></div>`}};it([$()],st.prototype,"DOID",2),it([$()],st.prototype,"item",2),it([z()],st.prototype,"cooked",2),it([z()],st.prototype,"meta",2),st=it([f("doid-coll-item")],st);var ot=Object.defineProperty,rt=Object.getOwnPropertyDescriptor,nt=(t,e,i,s)=>{for(var o,r=s>1?void 0:s?rt(e,i):e,n=t.length-1;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&ot(e,i,r),r};let at=class extends(_(a(":host::part(inner){display:flex;height:2rem;width:100%;align-items:center;justify-content:center}@media (min-width: 1024px){:host::part(inner){height:2.5rem}}\n"),{persistent:!0})){constructor(){super(...arguments),this.pageSize=5,this.page=1,this.mode="scroll",this.pending=!1,this.firstLoad=!0,this.empty=!1,this.nomore=!1,this.class="",this.onObserved=()=>{this.scrollMode&&this.loadmore()}}get canLoad(){return!(this.pending||this.nomore||this.empty||this.firstLoad)}get scrollMode(){return"scroll"===this.mode}loadmore(){if(!this.canLoad)return;const{pageSize:t,page:e,mode:i}=this;this.emit("loadmore",{pageSize:t,page:e,mode:i})}connectedCallback(){super.connectedCallback()}render(){return k`<div class="dui-pagination w-full flex justify-center items-center mt-4 ${S(this.$c([{nomore:this.nomore,"pointer-events-none":!this.canLoad},this.class]))}"><div part="inner" @click="${this.loadmore}">${D(this.empty,(()=>k`<slot name="empty"></slot>`),(()=>k`${D(this.nomore,(()=>k`<slot name="nomore"></slot>`),(()=>k`${D(this.pending,(()=>k`<slot name="loading"><loading-icon type="block"></loading-icon></slot>`),(()=>k`${D(!this.scrollMode&&!this.firstLoad,(()=>k`<slot><dui-link>Load more</dui-link></slot>`))}`))}`))}`))}</div></div>`}};nt([$({type:Number})],at.prototype,"pageSize",2),nt([$({type:Number})],at.prototype,"page",2),nt([$()],at.prototype,"mode",2),nt([$()],at.prototype,"pending",2),nt([$({type:Boolean})],at.prototype,"firstLoad",2),nt([$({type:Boolean})],at.prototype,"empty",2),nt([$({type:Boolean})],at.prototype,"nomore",2),nt([$()],at.prototype,"class",2),at=nt([f("dui-pagination")],at);var dt=Object.defineProperty,ct=Object.getOwnPropertyDescriptor,ht=(t,e,i,s)=>{for(var o,r=s>1?void 0:s?ct(e,i):e,n=t.length-1;n>=0;n--)(o=t[n])&&(r=(s?o(e,i,r):o(r))||r);return s&&r&&dt(e,i,r),r};let lt=class extends(a("")){constructor(){super(...arguments),this.pending=!1,this.err="",this.ts=0,this.collections=[],this.nomore=!1,this.page=1,this.pageSize=5,this.loadmore=()=>{this.page++,this.getCollections()}}get doid(){return this.DOID?.doid}get empty(){return!(this.err||!this.doid||!this.ts||this.collections.length)}get pagination(){return{page:this.page,pageSize:this.pageSize}}async getCollections(){if(this.pending)return;const{owner:t=""}=await v(this.doid);if(t){this.pending=!0,this.err="";try{const i=await e({minter:t,doid:this.doid},this.pagination);this.collections.push(...i),this.nomore=i.length<this.pageSize}catch(i){this.err=i.message||i}finally{this.ts++,this.pending=!1}}}connectedCallback(){super.connectedCallback(),this.getCollections()}render(){return k`<div class="doid-collections">${D(this.err,(()=>k`${this.err}`))} ${D(this.collections.length,(()=>k`<div class="grid gap-4">${L(this.collections,(t=>k`${j(t,k`<div class="bg-gray-100 mb-1 break-words break-all rounded-md"><doid-coll-item .DOID="${this.DOID}" .item="${t}"></doid-coll-item></div>`)}`))}</div>`))} ${D(!this.err,(()=>k`<dui-pagination .pending="${this.pending}" .nomore="${this.nomore}" .firstLoad="${!this.ts}" .empty="${this.empty}" .pageSize="${this.pageSize}" .page="${this.page}" @loadmore="${this.loadmore}"><span slot="empty">No collection yet.</span></dui-pagination>`))}</div>`}};ht([$()],lt.prototype,"DOID",2),ht([z()],lt.prototype,"pending",2),ht([z()],lt.prototype,"err",2),ht([z()],lt.prototype,"ts",2),ht([z()],lt.prototype,"collections",2),ht([z()],lt.prototype,"nomore",2),ht([z()],lt.prototype,"page",2),ht([z()],lt.prototype,"pageSize",2),lt=ht([f("doid-collections")],lt)}}}));
